<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="public/styles/index.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500&display=swap"
      rel="stylesheet"
    />
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <main>
      <header>
        <img src="public/icons/logo.png" width="150px" />
        <h1>Cookie Cloud</h1>
        <div>
          <button type="button" onclick="show_hide()">
            <img src="public/icons/hamburger.png" width="50px" />
          </button>
        </div>
      </header>
      <div class="container">
        <div class="users-window">
          <div class="users-head">
            <h3>People</h3>
            <h4 class="users-count"></h4>
          </div>
          <div class="users-list"></div>
        </div>
        <div class="chat-window">
          <div class="chats"></div>
          <div class="user-input">
            <input id="user-msg" type="text" />
            <button type="button" id="user-send">SEND</button>
          </div>
        </div>
        <div class="room_space">
          <form action="" method="post">
            <div class="room_1">
              <h1>1번방</h1>
              <h1 id="join_check_1">( 0 / 2 )</h1>
              <input style="display: none" value="1" name="room" />
              <button type="submit" id="room_btn_1" class="room_option">
                입장
              </button>
            </div>
          </form>
          <form action="" method="post">
            <div class="room_2">
              <h1>2번방</h1>
              <h1 id="join_check_2">( 0 / 2 )</h1>
              <input style="display: none" value="2" name="room" />
              <button type="submit" id="room_btn_2" class="room_option">
                입장
              </button>
            </div>
          </form>
          <form action="" method="post">
            <div class="room_3">
              <h1>3번방</h1>
              <h1 id="join_check_3">( 0 / 2 )</h1>
              <input style="display: none" value="3" name="room" />
              <button type="submit" id="room_btn_3" class="room_option">
                입장
              </button>
            </div>
          </form>
          <!-- <button type="submit" id="sub_btn"></button> -->
        </div>
      </div>
    </main>
    <script>
      // ejs구문을 사용해서 app.get 에서 넘겨준 user:username.ids 가져옴
      const username = "<%= user %>";
    </script>
    <script src="public/js/client.js"></script>
    <script>
      console.log(username);

      // const socket = io.connect();

      // 접속유저 주소 받아오기
      // socket.emit("joinChat", "hyhy");

      let uwindow = document.querySelector(".users-window");
      function show_hide() {
        if (uwindow.style.display == "block") {
          uwindow.style.display = "none";
        } else {
          uwindow.style.display = "block";
        }
      }

      // console.log(users_info);

      let input = document.getElementById("user-msg");
      input.addEventListener("keyup", function (e) {
        if (e.keyCode === 13) {
          e.preventDefault();
          document.getElementById("user-send").click();
        }
      });
      // users_data : 유저 아이디
      let join_num = 0;
      let join_user_check = 0;
      let room_btn = document.querySelectorAll(".room_option");
      for (const key in room_btn) {
        if (Object.hasOwnProperty.call(room_btn, key)) {
          const element = room_btn[key];
          element.onclick = () => {
            // 제출 버튼 입력
            // sub_btn.onclick = () => {};
            console.log(key + "번버튼");
          };
        }
      }
      // setInterval(() => {
      //   join_check.innerHTML = `( ${join_num} / 2 )`;
      // }, 500);
      // room_btn[].onclick = () => {
      //   // room_bt;
      //   if (users_data != null) {
      //     console.log("버튼");
      //     // 안받아
      //     if (join_num == 2) {
      //       return;
      //     }
      //     if (join_user_check == 1) {
      //       return;
      //     }
      //     socket.emit("joinRoom", users_data, r);
      //     // socket.on("joinRoom", (_temp) => {
      //     //   join_num = _temp;
      //     //   join_user_check = 1;
      //     //   join_check.innerHTML = `( ${join_num} / 2 )`;
      //     //   console.log(join_num);
      //     // });
      //     // room에 넣어주기;
      //   }
      // };
    </script>

    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
  </body>
</html>
